<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Rerum Login</title>
</head>
<style>
    @keyframes glow {
        0% { box-shadow: 0 0 5px rgba(42, 223, 36, 0.5); }
        50% { box-shadow: 0 0 20px rgba(42, 223, 36, 0.8), 0 0 30px rgba(42, 223, 36, 0.6); }
        100% { box-shadow: 0 0 5px rgba(42, 223, 36, 0.5); }
    }

    body {
        background-color: black;
        color: white;
        font-family: sans-serif;
    }

    #title {
        text-align: center;
        padding-top: 15%;
    }

    #username, #password {
        background-color: transparent;
        border: 1px solid rgb(42, 223, 36);
        color: white;
        padding: 5px;
        margin: 5px 0;
        text-align: center;
    }

    #loginButton {
        background-color: rgb(239, 239, 239);
        color: black;
        border: none;
        padding: 8px 15px;
        margin-top: 15px;
        cursor: pointer;
        font-weight: bold;
        transition: background-color 0.3s;
    }

    #loginButton:hover {
        background-color: rgb(36, 180, 30);
    }

    #hint {
        color: rgb(42, 223, 36);
        text-decoration: none; 
        cursor: pointer;
        padding: 10px;
    }

    footer {
        color: red;
        font-family: monospace;
        position: fixed;
        bottom: 0;
        left: 0;
        padding: 10px;
    }

    .modal {
        display: none; 
        position: fixed; 
        z-index: 1; 
        left: 0;
        top: 0;
        width: 100%;
        height: 100%; 
        overflow: auto; 
        background-color: rgba(0,0,0,0.8); 
        padding-top: 150px;
    }

    .modal-content {
        background-color: #111; 
        margin: auto;
        padding: 20px;
        border: 1px solid rgb(42, 223, 36);
        width: 50%;
        max-width: 400px;
        color: rgb(42, 223, 36);
        text-align: center;
        animation: glow 3s infinite alternate; 
    }

    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: rgb(255, 0, 0); 
        text-decoration: none;
        cursor: pointer;
    }
</style>
<body>
    
    <a id="hint" onclick="document.getElementById('hintModal').style.display='block'">hint?</a>
    
    <div id="title">
        <form id="loginForm"> 
            <i>Matrix Rerum</i><br><br>
            <input type="text" id="username" name="username"><br>
            <input type="password" id="password" name="password"><br>
            <button type="submit" id="loginButton"></button>
        </form>
    </div>

    <div id="hintModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('hintModal').style.display='none'">&times;</span>
            <p>
                The visible <i>System</i>, the Name the Creator sings; The <i>Engine's</i> first language, The Mother of Things. 
                <br><br>
                I need the <i>Core</i> to proceed, the brain of the whole, The privileged command that takes <i>absolute</i> control. 
            </p>
            <p style="font-size: 0.8em; margin-top: 20px;">
                (Think components)
            </p>
        </div>
    </div>
    
    <footer>
        Mother of Things
    </footer>

    <script>
        const loginForm = document.getElementById('loginForm');

        async function handleLogin(event) {
            // Prevent the default form submission (which reloads the page)
            event.preventDefault(); 

            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            try {
                const response = await fetch('/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json' 
                    },
                    body: JSON.stringify({ username, password }) 
                });

                const result = await response.json();

                if (result.success) {
                    window.location.href = result.redirect; 
                } else {
                    window.location.href = result.redirect; 
                }

            } catch (error) {
                console.error('Login failed due to a server error:', error);
                alert('Connection error. Try again.');
            }
        }

        loginForm.addEventListener('submit', handleLogin);
    </script>
</body>
</html>